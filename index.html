<!DOCTYPE html>
<html>
<head>
<title>FF TCG card searcher</title>
<style>
  #list {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    list-style: none;
    padding: 0;
  }
  #list li {
    display: block;
    flex-grow: 1;
    width: 260px;
    aspect-ratio: 5 / 7;
    overflow: clip;
  }
  #list li img {
    width: 100%;
  }
</style>
</head>
<body>
<ul id="list"></ul>

<script>
  fetch('cards.json')
    .then(response => response.json())
    .then(data => {
      const list = document.getElementById('list');
      data.forEach(card => {
        const listItem = document.createElement('li');
        const imgElement = document.createElement('img');
        imgElement.src = `https://fftcg.cdn.sewest.net/images/cards/full/${card.image_file.match(/\/([^\/.]+)\./)[1]}_eg.jpg`;
        
        imgElement.onerror = function() {
          this.onerror = function() {
              this.onerror = null;
              // second fallback
              this.src = `http://www.square-enix-shop.com/jp/ff-tcg/card/cimg/thumb/${card.image_file}`;
          };
          // first fallback
          if (card.image_file.includes('_FL')) {
            this.src = `https://fftcg.cdn.sewest.net/images/cards/full/${card.image_file.match(/\/([^\/.]+)\./)[1].replace('FL', 'eg_FL')}.jpg`;
          } else {
            this.src = `http://www.square-enix-shop.com/jp/ff-tcg/card/cimg/thumb/${card.image_file}`;
          }
        };

        imgElement.loading = "lazy";
        imgElement.alt = card.code;
        listItem.appendChild(imgElement);
        list.appendChild(listItem);
      });
    })
    .catch(error => {
      console.error('Error loading JSON:', error);
    });
</script>
</body>
</html>